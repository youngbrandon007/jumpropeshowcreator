import{s as O,g as V,r as L,G as F,B as j,L as z,u as J,a as M,d as W}from"./vuedraggable.umd-Dlwy5Grl.js";import{g as T,h as Y,i as H,d as I,u as C,j as K,w as p,k as o,o as P,e as u,l as N,a as n,G as q,r as Q,Y as X,S as Z,m as ee,n as te,v as ne,c as $,b as w,F as se,t as y}from"./index-InCvxbtX.js";import{_ as oe}from"./TabReference.vue_vue_type_script_setup_true_lang-BgFcauZR.js";function ie(i,a,t,l,d){let e=0;return i.forEach((s,r)=>{const m=r+l;e+=ae(s,a,t,m,d);const f=s[1];a[f]=m;for(let v=3;v<s.length;v++){const S=s[v];t[S]=m}}),e}function ae(i,a,t,l,d){let e=0;const s=i[1];a[s]!==-1&&(e+=d.event(a[s]-l));for(let r=3;r<i.length;r++){const m=i[r];t[m]!==-1&&(e+=d.person(t[m]-l))}return e}const A={encourageEventMinimumSpacing:2,encourageEventMinimumSpacingStrength:4,encouragePersonMinimumSpacing:2,encouragePersonMinimumSpacingStrength:8,personSpacingMultiplier:10,eventSpacingMultiplier:5};function le(i){return{event:a=>{const t=Math.abs(a);return Math.log(t+1)*i.eventSpacingMultiplier+(t>i.encourageEventMinimumSpacing?i.encourageEventMinimumSpacingStrength:0)},person:a=>{const t=Math.abs(a);return Math.log(t+1)*i.personSpacingMultiplier+(t>i.encouragePersonMinimumSpacing?i.encouragePersonMinimumSpacingStrength:0)}}}function re(i,a,t,l,d,e,s){if(i[a]!==null)throw Error("Internal Error in findNextBestIndexRandomly()");let r=-1,m=-1;for(let f=0;f<t.length;f++){const v=i.map(x=>x);v[a]=t[f];const S=t.filter((x,_)=>_!==f);let c=0;for(let x=0;x<l;x++){const _=V(v,S),E=ie(_,Array(d).fill(-1),Array(e).fill(-1),0,s);c+=E}c>r&&(r=c,m=f)}return m}function ue(i,a,t){const{processedEntries:l,personToIndex:d,indexToPerson:e,allPeople:s,allEvents:r,eventToIndex:m,indexToEvent:f}=O(i),v=[],S=[];l.forEach(g=>{g[2]!==-1?S.push(g):v.push(g)}),S.sort((g,b)=>g[0]-b[0]);const c=Array(i.length).fill(null);let x=0;for(let g=0;g<c.length;g++){const b=S.length-x;if(b===0)break;const D=c.length-g,U=100*g/(c.length-1)+.01;(D<=b||S[x][2]<=U)&&(c[g]=S[x],x++)}const _=a.iterations,E=performance.now();for(let g=0;g<c.length;g++)if(c[g]===null){const b=re(c,g,v,_,r.size,s.size,t);c[g]=v.splice(b,1)[0]}const R=performance.now()-E;console.log("Created show in "+R.toFixed(3)+" ms.");const B=c.map(g=>i[g[0]]);return{allPeople:s,personToIndex:d,indexToPerson:e,allEvents:r,eventToIndex:m,indexToEvent:f,result:B}}const G={name:"random",iterations:100};function ge(i,a,t){const l=le(t);switch(a.name){case"random":default:return ue(i,a,l)}}function k(i,a){let t=JSON.parse(localStorage.getItem(i)??"null")??a;const l=T(t);return Y(l,d=>{localStorage.setItem(i,JSON.stringify(d))}),l}const de=H("show",()=>{let i=k("show",[]);const a=k("generatorSettings",G),t=k("evaluatorSettings",A);function l(s){i.value=s.map(r=>({id:L(),title:r.name!==""?r.name:r.event+" - "+r.people.join(", "),entry:r}))}function d(){const s=ge(i.value,a.value,t.value);i.value=s.result}function e(){const s=F({useKeysAsHeaders:!0,filename:"show"}),r=j(s)(i.value.map(m=>({title:m.title,event:m.entry.event,people:m.entry.people.reduce((f,v)=>f.length>0?f+", "+v:v,"")})));z(s)(r)}return{show:i,generatorSettings:a,evaluatorSettings:t,reset:l,generate:d,downloadCsv:e}}),me={class:"fixed inset-0 z-10 w-screen overflow-y-auto"},pe={class:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"},ve=I({__name:"CustomDialog",props:{open:{default:!0},openModifiers:{}},emits:["update:open"],setup(i){const a=C(i,"open");return(t,l)=>(P(),K(o(Z),{as:"template",show:a.value},{default:p(()=>[u(o(X),{class:"relative z-50",onClose:l[0]||(l[0]=d=>a.value=!1)},{default:p(()=>[u(o(N),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:p(()=>l[1]||(l[1]=[n("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"},null,-1)])),_:1}),n("div",me,[n("div",pe,[u(o(N),{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:p(()=>[u(o(q),{class:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-sm sm:p-6"},{default:p(()=>[Q(t.$slots,"default")]),_:3})]),_:3})])])]),_:3})]),_:3},8,["show"]))}}),ce=["min","max"],h=I({__name:"InputSlider",props:ee({min:{},max:{}},{value:{},valueModifiers:{}}),emits:["update:value"],setup(i){const a=C(i,"value");return(t,l)=>te((P(),$("input",{type:"range","onUpdate:modelValue":l[0]||(l[0]=d=>a.value=d),min:t.min,max:t.max,class:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer dark:bg-gray-700"},null,8,ce)),[[ne,a.value]])}}),fe={class:"px-4 sm:px-6 lg:px-8"},xe={class:"sm:flex sm:items-center"},Se={class:"sm:flex-auto"},we={class:"mt-2 text-sm text-gray-700"},ye={class:"mt-8 flow-root"},he={class:"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},be={class:"inline-block min-w-full py-2 align-middle"},Me={class:"flex flex-row justify-center p-2 gap-2"},_e={class:"min-w-full divide-y divide-gray-300"},Ee={class:"handle"},ke={class:"whitespace-nowrap py-2 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 lg:pl-8"},Ie={class:"flex flex-col gap-8"},Pe={class:"flex flex-col gap-4"},Ne={class:"flex flex-row gap-4 items-center"},Te={class:"w-24 text-right"},Ce={class:"flex flex-col gap-4"},$e={class:"flex flex-row gap-4 items-center"},Ae={class:"w-24 text-right"},Ge={class:"flex flex-row gap-4 items-center"},Re={class:"w-24 text-right"},Be={class:"flex flex-row gap-4 items-center"},De={class:"w-24 text-right"},Ue={class:"flex flex-col gap-4"},Oe={class:"flex flex-row gap-4 items-center"},Ve={class:"w-24 text-right"},Le={class:"flex flex-row gap-4 items-center"},Fe={class:"w-24 text-right"},je={class:"flex flex-row gap-4 items-center"},ze={class:"w-24 text-right"},He=I({__name:"ShowView",setup(i){const a=J(),t=de(),l=T(!1);return(d,e)=>(P(),$(se,null,[n("div",fe,[n("div",xe,[n("div",Se,[e[17]||(e[17]=n("h1",{class:"text-base font-semibold leading-6 text-gray-900"},"Show",-1)),n("p",we,[e[15]||(e[15]=w("First go to the ")),u(oe,{to:"/entries"},{default:p(()=>e[14]||(e[14]=[w("Entries")])),_:1}),e[16]||(e[16]=w(" tab and add the entries to your show. Then click 'Import Entries and Reset Show' to load in your entries from the other tab. Then click 'Generate' to create an order where like event types and people are spaced out."))])])]),n("div",ye,[n("div",he,[n("div",be,[n("div",Me,[u(M,{onClick:e[0]||(e[0]=s=>o(t).reset(o(a).getProcessedValue()))},{default:p(()=>e[18]||(e[18]=[w("Import Entries and Reset Show")])),_:1}),u(M,{onClick:e[1]||(e[1]=s=>o(t).generate())},{default:p(()=>e[19]||(e[19]=[w("Generate")])),_:1}),u(M,{onClick:e[2]||(e[2]=s=>l.value=!0)},{default:p(()=>e[20]||(e[20]=[w("Generator Settings")])),_:1}),e[22]||(e[22]=n("div",{class:"grow"},null,-1)),u(M,{onClick:e[3]||(e[3]=s=>o(t).downloadCsv())},{default:p(()=>e[21]||(e[21]=[w("Download")])),_:1})]),n("table",_e,[e[23]||(e[23]=n("thead",null,[n("tr",null,[n("th",{scope:"col"},[n("span",{class:"sr-only"},"Number")]),n("th",{scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6 lg:pl-8"},"Title"),n("th",{scope:"col",class:"relative py-3.5 pl-3 pr-4 sm:pr-6 lg:pr-8"},[n("span",{class:"sr-only"},"Options")])])],-1)),u(o(W),{class:"divide-y divide-gray-200 bg-white",list:o(t).show,"item-key":"id",tag:"tbody",handle:".handle"},{item:p(({element:s,index:r})=>[n("tr",null,[n("td",Ee,y(r+1),1),n("td",ke,y(s.title),1)])]),_:1},8,["list"])])])])])]),u(ve,{open:l.value,"onUpdate:open":e[13]||(e[13]=s=>l.value=s)},{default:p(()=>[n("div",Ie,[n("div",Pe,[e[27]||(e[27]=n("h1",{class:"text-base font-semibold leading-6 text-gray-900"},"Generator Settings",-1)),u(M,{onClick:e[4]||(e[4]=s=>{o(t).generatorSettings=o(G),o(t).evaluatorSettings=o(A)})},{default:p(()=>e[24]||(e[24]=[w("Reset All Settings")])),_:1}),n("div",null,[e[25]||(e[25]=n("label",{for:"iterations",class:"block text-sm font-medium leading-6 text-gray-900"},"Iterations ",-1)),e[26]||(e[26]=n("small",{class:"block text-xs text-gray-500 font-medium leading-6"},"(higher may take longer to run but will get a better result)",-1)),n("div",Ne,[u(h,{id:"iterations",min:"10",max:"40",value:Math.log10(o(t).generatorSettings.iterations)*10,"onUpdate:value":e[5]||(e[5]=s=>o(t).generatorSettings={...o(t).generatorSettings,iterations:10**(Number(s)/10)})},null,8,["value"]),n("p",Te,y(Math.round(o(t).generatorSettings.iterations)),1)])])]),n("div",Ce,[e[32]||(e[32]=n("h1",{class:"text-base font-semibold leading-6 text-gray-900"},"Generator Event Settings",-1)),n("div",null,[e[28]||(e[28]=n("label",{for:"event_priority",class:"block text-sm font-medium leading-6 text-gray-900"},"Event Spacing Priority",-1)),n("div",$e,[u(h,{id:"event_priority",min:"0",max:"10",value:o(t).evaluatorSettings.eventSpacingMultiplier,"onUpdate:value":e[6]||(e[6]=s=>o(t).evaluatorSettings={...o(t).evaluatorSettings,eventSpacingMultiplier:Number(s)})},null,8,["value"]),n("p",Ae,y(Math.round(o(t).evaluatorSettings.eventSpacingMultiplier)),1)])]),n("div",null,[e[29]||(e[29]=n("label",{for:"event_min_spacing",class:"block text-sm font-medium leading-6 text-gray-900"},"Event Minimum Spacing ",-1)),e[30]||(e[30]=n("small",{class:"block text-xs text-gray-500 font-medium leading-6"},"(will not guarantee this spacing but will encourage the algorithm)",-1)),n("div",Ge,[u(h,{id:"event_min_spacing",min:"0",max:"10",value:o(t).evaluatorSettings.encourageEventMinimumSpacing,"onUpdate:value":e[7]||(e[7]=s=>o(t).evaluatorSettings={...o(t).evaluatorSettings,encourageEventMinimumSpacing:Number(s)})},null,8,["value"]),n("p",Re,y(Math.round(o(t).evaluatorSettings.encourageEventMinimumSpacing)),1)])]),n("div",null,[e[31]||(e[31]=n("label",{for:"event_min_spacing_strength",class:"block text-sm font-medium leading-6 text-gray-900"},"Event Minimum Spacing Priority",-1)),n("div",Be,[u(h,{id:"event_min_spacing_strength",min:"0",max:"10",value:o(t).evaluatorSettings.encourageEventMinimumSpacingStrength,"onUpdate:value":e[8]||(e[8]=s=>o(t).evaluatorSettings={...o(t).evaluatorSettings,encourageEventMinimumSpacingStrength:Number(s)})},null,8,["value"]),n("p",De,y(Math.round(o(t).evaluatorSettings.encourageEventMinimumSpacingStrength)),1)])])]),n("div",Ue,[e[37]||(e[37]=n("h1",{class:"text-base font-semibold leading-6 text-gray-900"},"Person Event Settings",-1)),n("div",null,[e[33]||(e[33]=n("label",{for:"person_priority",class:"block text-sm font-medium leading-6 text-gray-900"},"Person Spacing Priority",-1)),n("div",Oe,[u(h,{id:"person_priority",min:"0",max:"10",value:o(t).evaluatorSettings.personSpacingMultiplier,"onUpdate:value":e[9]||(e[9]=s=>o(t).evaluatorSettings={...o(t).evaluatorSettings,personSpacingMultiplier:Number(s)})},null,8,["value"]),n("p",Ve,y(Math.round(o(t).evaluatorSettings.personSpacingMultiplier)),1)])]),n("div",null,[e[34]||(e[34]=n("label",{for:"person_min_spacing",class:"block text-sm font-medium leading-6 text-gray-900"},"Person Minimum Spacing ",-1)),e[35]||(e[35]=n("small",{class:"block text-xs text-gray-500 font-medium leading-6"},"(will not guarantee this spacing but will encourage the algorithm)",-1)),n("div",Le,[u(h,{id:"person_min_spacing",min:"0",max:"10",value:o(t).evaluatorSettings.encouragePersonMinimumSpacing,"onUpdate:value":e[10]||(e[10]=s=>o(t).evaluatorSettings={...o(t).evaluatorSettings,encouragePersonMinimumSpacing:Number(s)})},null,8,["value"]),n("p",Fe,y(Math.round(o(t).evaluatorSettings.encouragePersonMinimumSpacing)),1)])]),n("div",null,[e[36]||(e[36]=n("label",{for:"person_min_spacing_strength",class:"block text-sm font-medium leading-6 text-gray-900"},"Person Minimum Spacing Priority",-1)),n("div",je,[u(h,{id:"person_min_spacing_strength",min:"0",max:"10",value:o(t).evaluatorSettings.encouragePersonMinimumSpacingStrength,"onUpdate:value":e[11]||(e[11]=s=>o(t).evaluatorSettings={...o(t).evaluatorSettings,encouragePersonMinimumSpacingStrength:Number(s)})},null,8,["value"]),n("p",ze,y(Math.round(o(t).evaluatorSettings.encouragePersonMinimumSpacingStrength)),1)])])]),u(M,{onClick:e[12]||(e[12]=s=>l.value=!1)},{default:p(()=>e[38]||(e[38]=[w("Done")])),_:1})])]),_:1},8,["open"])],64))}});export{He as default};
