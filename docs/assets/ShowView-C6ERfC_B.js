import{G as N,B as A,L as B,u as M}from"./entries-DQdW3JGn.js";import{g as R,r as V,h as L,d as O,c as b,a as r,b as y,e as P,w as D,u as x,F,i as $,o as I,t as S}from"./index-BKUdSpyx.js";import{_ as z}from"./TabReference.vue_vue_type_script_setup_true_lang-DhsnvYkI.js";function w(o){return o.trim().toLowerCase()}function T(o){const s=new Map,n=new Map;let a=0;return o.forEach(e=>{s.set(e,a),n.set(a,e),a+=1}),{itemToIndex:s,indexToItem:n}}function G(o){const s=new Set(o.flatMap(i=>i.entry.people.map(w))),{itemToIndex:n,indexToItem:a}=T(s),e=new Set(o.map(i=>w(i.entry.event))),{itemToIndex:t,indexToItem:l}=T(e);return{processedEntries:o.map((i,d)=>[d,t.get(w(i.entry.event)),i.entry.percentage??-1].concat(i.entry.people.map(p=>n.get(w(p))))),allPeople:s,personToIndex:n,indexToPerson:a,allEvents:e,eventToIndex:t,indexToEvent:l}}function j(o,s,n,a=0){let e=0;return o.forEach((t,l)=>{const u=l+a;e+=J(t,s,n,u);const i=t[1];s[i]=u;for(let d=3;d<t.length;d++){const p=t[d];n[p]=u}}),e}function J(o,s,n,a){let e=0;const t=o[1];s[t]!==-1&&(e+=E(s[t]-a));for(let l=3;l<o.length;l++){const u=o[l];n[u]!==-1&&(e+=E(n[u]-a))}return e}function E(o){return Math.log2(Math.abs(o))}function W(o,s){const n=[],a=s.map(t=>t),e=crypto.getRandomValues(new Uint32Array(o.length));for(let t=0;t<o.length;t++)if(o[t]!==null)n.push(o[t]);else{const l=Math.floor(e[0]*a.length/4294967296);n.push(a.splice(l,1)[0])}return n}function H(o,s,n,a,e,t){if(o[s]!==null)throw Error("Internal Error in findNextBestIndexRandomly()");let l=-1,u=-1;for(let i=0;i<n.length;i++){const d=o.map(m=>m);d[s]=n[i];const p=n.filter((m,h)=>h!==i);let f=0;for(let m=0;m<a;m++){const h=W(d,p),v=j(h,Array(e).fill(-1),Array(t).fill(-1));f+=v}f>l&&(l=f,u=i)}return u}function K(o){const{processedEntries:s,personToIndex:n,indexToPerson:a,allPeople:e,allEvents:t,eventToIndex:l,indexToEvent:u}=G(o),i=[],d=[];s.forEach(c=>{c[2]!==-1?d.push(c):i.push(c)}),d.sort((c,g)=>c[0]-g[0]);const p=Array(o.length).fill(null);let f=0;for(let c=0;c<p.length;c++){const g=d.length-f;if(g===0)break;const k=p.length-c,C=100*c/(p.length-1)+.01;(k<=g||d[f][2]<=C)&&(p[c]=d[f],f++)}const m=100,h=performance.now();for(let c=0;c<p.length;c++)if(p[c]===null){const g=H(p,c,i,m,t.size,e.size);p[c]=i.splice(g,1)[0]}const v=performance.now()-h;console.log("Created show in "+v.toFixed(3)+" ms.");const _=p.map(c=>o[c[0]]);return{allPeople:e,personToIndex:n,indexToPerson:a,allEvents:t,eventToIndex:l,indexToEvent:u,result:_}}const q=R("show",()=>{let o=[];try{o=JSON.parse(localStorage.getItem("show")??"[]")}catch(t){console.error(t)}const s=V(o);L(s,t=>{localStorage.setItem("show",JSON.stringify(t))});function n(t){s.value=t.map(l=>({title:l.name!==""?l.name:l.event+" - "+l.people.join(", "),entry:l}))}function a(){const t=K(s.value);s.value=t.result}function e(){const t=N({useKeysAsHeaders:!0,filename:"show"}),l=A(t)(s.value.map(u=>({title:u.title,event:u.entry.event,people:u.entry.people.reduce((i,d)=>i.length>0?i+", "+d:d,"")})));B(t)(l)}return{show:s,reset:n,generate:a,downloadCsv:e}}),Q={class:"px-4 sm:px-6 lg:px-8"},X={class:"sm:flex sm:items-center"},Y={class:"sm:flex-auto"},Z={class:"mt-2 text-sm text-gray-700"},U={class:"mt-8 flow-root"},ee={class:"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},te={class:"inline-block min-w-full py-2 align-middle"},oe={class:"flex flex-row justify-center p-2 gap-2"},ne={class:"min-w-full divide-y divide-gray-300"},se={class:"divide-y divide-gray-200 bg-white"},le={class:"whitespace-nowrap py-2 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 lg:pl-8"},ce=O({__name:"ShowView",setup(o){const s=M(),n=q();return(a,e)=>(I(),b("div",Q,[r("div",X,[r("div",Y,[e[6]||(e[6]=r("h1",{class:"text-base font-semibold leading-6 text-gray-900"},"Show",-1)),r("p",Z,[e[4]||(e[4]=y("First go to the ")),P(z,{to:"/entries"},{default:D(()=>e[3]||(e[3]=[y("Entries")])),_:1}),e[5]||(e[5]=y(" tab and add the entries to your show. Then click 'Import Entries and Reset Show' to load in your entries from the other tab. Then click 'Generate' to create an order where like event types and people are spaced out."))])])]),r("div",U,[r("div",ee,[r("div",te,[r("div",oe,[r("button",{type:"button",onClick:e[0]||(e[0]=t=>x(n).reset(x(s).getProcessedValue())),class:"block rounded-md bg-indigo-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},"Import Entries and Reset Show"),r("button",{type:"button",onClick:e[1]||(e[1]=t=>x(n).generate()),class:"block rounded-md bg-indigo-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},"Generate"),e[7]||(e[7]=r("div",{class:"grow"},null,-1)),r("button",{type:"button",onClick:e[2]||(e[2]=t=>x(n).downloadCsv()),class:"block rounded-md bg-indigo-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},"Download")]),r("table",ne,[e[8]||(e[8]=r("thead",null,[r("tr",null,[r("th",{scope:"col"},[r("span",{class:"sr-only"},"Number")]),r("th",{scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6 lg:pl-8"},"Title"),r("th",{scope:"col",class:"relative py-3.5 pl-3 pr-4 sm:pr-6 lg:pr-8"},[r("span",{class:"sr-only"},"Options")])])],-1)),r("tbody",se,[(I(!0),b(F,null,$(x(n).show,(t,l)=>(I(),b("tr",{key:l},[r("td",null,S(l+1),1),r("td",le,S(t.title),1)]))),128))])])])])])]))}});export{ce as default};
