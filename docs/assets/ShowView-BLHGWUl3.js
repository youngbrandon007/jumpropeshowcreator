import{u as C,_ as M}from"./TabReference.vue_vue_type_script_setup_true_lang-BcQlVB9s.js";import{d as R,r as V,w as A,a as B,o as b,c as y,b as l,e as I,f as O,g as P,u as x,F,h as L,t as S}from"./index-BkzSL0VM.js";function w(o){return o.trim().toLowerCase()}function _(o){const s=new Map,n=new Map;let r=0;return o.forEach(e=>{s.set(e,r),n.set(r,e),r+=1}),{itemToIndex:s,indexToItem:n}}function z(o){const s=new Set(o.flatMap(i=>i.entry.people.map(w))),{itemToIndex:n,indexToItem:r}=_(s),e=new Set(o.map(i=>w(i.entry.event))),{itemToIndex:t,indexToItem:c}=_(e);return{processedEntries:o.map((i,u)=>[u,t.get(w(i.entry.event)),i.entry.percentage??-1].concat(i.entry.people.map(d=>n.get(w(d))))),allPeople:s,personToIndex:n,indexToPerson:r,allEvents:e,eventToIndex:t,indexToEvent:c}}function D(o,s,n,r=0){let e=0;return o.forEach((t,c)=>{const p=c+r;e+=$(t,s,n,p);const i=t[1];s[i]=p;for(let u=3;u<t.length;u++){const d=t[u];n[d]=p}}),e}function $(o,s,n,r){let e=0;const t=o[1];s[t]!==-1&&(e+=T(s[t]-r));for(let c=3;c<o.length;c++){const p=o[c];n[p]!==-1&&(e+=T(n[p]-r))}return e}function T(o){return Math.log2(Math.abs(o))}function j(o,s){const n=[],r=s.map(t=>t),e=crypto.getRandomValues(new Uint32Array(o.length));for(let t=0;t<o.length;t++)if(o[t]!==null)n.push(o[t]);else{const c=Math.floor(e[0]*r.length/4294967296);n.push(r.splice(c,1)[0])}return n}function J(o,s,n,r,e,t){if(o[s]!==null)throw Error("Internal Error in findNextBestIndexRandomly()");let c=-1,p=-1;for(let i=0;i<n.length;i++){const u=o.map(m=>m);u[s]=n[i];const d=n.filter((m,h)=>h!==i);let f=0;for(let m=0;m<r;m++){const h=j(u,d),v=D(h,Array(e).fill(-1),Array(t).fill(-1));f+=v}f>c&&(c=f,p=i)}return p}function q(o){const{processedEntries:s,personToIndex:n,indexToPerson:r,allPeople:e,allEvents:t,eventToIndex:c,indexToEvent:p}=z(o),i=[],u=[];s.forEach(a=>{a[2]!==-1?u.push(a):i.push(a)}),u.sort((a,g)=>a[0]-g[0]);const d=Array(o.length).fill(null);let f=0;for(let a=0;a<d.length;a++){const g=u.length-f;if(g===0)break;const N=d.length-a,k=100*a/(d.length-1)+.01;(N<=g||u[f][2]<=k)&&(d[a]=u[f],f++)}const m=100,h=performance.now();for(let a=0;a<d.length;a++)if(d[a]===null){const g=J(d,a,i,m,t.size,e.size);d[a]=i.splice(g,1)[0]}const v=performance.now()-h;console.log("Created show in "+v.toFixed(3)+" ms.");const E=d.map(a=>o[a[0]]);return{allPeople:e,personToIndex:n,indexToPerson:r,allEvents:t,eventToIndex:c,indexToEvent:p,result:E}}const G=R("show",()=>{let o=[];try{o=JSON.parse(localStorage.getItem("show")??"[]")}catch(e){console.error(e)}const s=V(o);A(s,e=>{localStorage.setItem("show",JSON.stringify(e))});function n(e){s.value=e.map(t=>({title:t.name!==""?t.name:t.event+" - "+t.people.join(", "),entry:t}))}function r(){const e=q(s.value);s.value=e.result}return{show:s,reset:n,generate:r}}),H={class:"px-4 sm:px-6 lg:px-8"},K={class:"sm:flex sm:items-center"},Q={class:"sm:flex-auto"},W={class:"mt-2 text-sm text-gray-700"},X={class:"mt-8 flow-root"},Y={class:"-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8"},Z={class:"inline-block min-w-full py-2 align-middle"},U={class:"flex flex-row justify-center p-2 gap-2"},ee={class:"min-w-full divide-y divide-gray-300"},te={class:"divide-y divide-gray-200 bg-white"},oe={class:"whitespace-nowrap py-2 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6 lg:pl-8"},le=B({__name:"ShowView",setup(o){const s=C(),n=G();return(r,e)=>(b(),y("div",H,[l("div",K,[l("div",Q,[e[5]||(e[5]=l("h1",{class:"text-base font-semibold leading-6 text-gray-900"},"Show",-1)),l("p",W,[e[3]||(e[3]=I("First go to the ")),O(M,{to:"/entries"},{default:P(()=>e[2]||(e[2]=[I("Entries")])),_:1}),e[4]||(e[4]=I(" tab and add the entries to your show."))])])]),l("div",X,[l("div",Y,[l("div",Z,[l("div",U,[l("button",{type:"button",onClick:e[0]||(e[0]=t=>x(n).reset(x(s).getProcessedValue())),class:"block rounded-md bg-indigo-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},"Import Entries and Reset Show"),l("button",{type:"button",onClick:e[1]||(e[1]=t=>x(n).generate()),class:"block rounded-md bg-indigo-600 px-3 py-2 text-center text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},"Regenerate")]),l("table",ee,[e[6]||(e[6]=l("thead",null,[l("tr",null,[l("th",{scope:"col"},[l("span",{class:"sr-only"},"Number")]),l("th",{scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6 lg:pl-8"},"Title"),l("th",{scope:"col",class:"relative py-3.5 pl-3 pr-4 sm:pr-6 lg:pr-8"},[l("span",{class:"sr-only"},"Options")])])],-1)),l("tbody",te,[(b(!0),y(F,null,L(x(n).show,(t,c)=>(b(),y("tr",{key:c},[l("td",null,S(c+1),1),l("td",oe,S(t.title),1)]))),128))])])])])])]))}});export{le as default};
